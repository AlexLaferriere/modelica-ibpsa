############################################################
# Makefile for the regression tests that are run on travis
############################################################
ROOT = ../../../..

test-documentation:
	(cd $(ROOT)/IBPSA; ../bin/runUnitTests.py --validate-html-only)

test-autogenerated-files:
	# Check for package.order to be up to date
	(cd  $(ROOT)/IBPSA; \
	  python -c 'import buildingspy.development.refactor as r; \
	  r.write_package_order(".", recursive=True)'; \
	  git diff --exit-code . )

	#echo Verify that all OpenModelica scripts are up to date, and no old scripts exist
	(cd  $(ROOT)/IBPSA; \
	  rm -rf $(ROOT)/IBPSA/Resources/Scripts/OpenModelica/compareVars/*.mos; \
	  python -c 'import buildingspy.development.regressiontest as u; \
	  u.Tester().writeOpenModelicaResultDictionary()')
	git status --porcelain $(ROOT)/IBPSA/Resources/Scripts/OpenModelica;
	test -z "$$(git status --porcelain $(ROOT)/IBPSA/Resources/Scripts/OpenModelica)"


test-dymola:
	(cd $(ROOT)/IBPSA && python ../bin/runUnitTests.py --batch --single-package $(PACKAGE))
